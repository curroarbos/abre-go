<div class="container my-2">
  <div class="row align-items-center">
    <div class="col-8">
      <h1>Welcome to recommendations for <%= @property.name %></h1>
    </div>
    <div class="col-4">
      <% if @property.photo.nil? %>
      <% else %>
        <%= image_tag @property.photo, alt: "#{@property.name} Main Photo", class: "img-thumbnail", width: 400, height: 400 %>
      <% end %>
    </div>
  </div>


  <% if @recommendations.empty? %>
    <p>You have not given any
    recommendations yet.</p>
    <% else %>
    <div class="mb-3">
    <div class="row my-2">
    <div class="col-12 col-lg-8">
      <div class="cards">
      <% @recommendations.each do |recommendation| %>
        <div class="mb-3">
          <%# <%= link_to activity_path(activity), class: "text-decoration-none text-dark" do %>
            <% if !recommendation.recommendable.photo_url.nil?  %>
              <div class="card-category" data-aos="zoom-in" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url('<%=recommendation.recommendable.photo_url%>')"> </div>
            <% else %>
              <div class="card-category" style="background-image: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), url('<%= cl_image_path recommendation.recommendable.photo.key, height: 300, crop: :fill %>')"> </div>
            <% end %>
            <div class="p-3 rounded-bottom d-flex flex-column">
              <div class="d-flex justify-content-between">
              <% if recommendation.recommendable_type == "Activity" %>
                <h4> <%= recommendation.recommendable.title %> </h4>
              <% else %>
                <h4> <%= recommendation.recommendable.name %> </h4>
              <% end %>
                <p class="text-muted font-weight-normal">
                <%# Get average rating %>
                <% if recommendation.recommendable_type == "Activity" %>
                  <% if recommendation.recommendable.reviews.empty? %>
                    No reviews yet
                  <% else %>
                    <%= (recommendation.recommendable.reviews.pluck(:rating).sum / recommendation.recommendable.reviews.pluck(:rating).length).round(1) %>
                    <i class="fa-solid fa-star text-warning"></i>
                  <% end %>
                <% else %>
                  <%= recommendation.recommendable.rating %>
                  <i class="fa-solid fa-star text-warning"></i>
                <% end %>
                </p>
              </div>
              <% if recommendation.recommendable_type == "Activity" %>
                <p> <%= recommendation.recommendable.location %> </p>
                <p> <strong><%= recommendation.recommendable.price %> â‚¬ </strong></p>
              <% else %>
                <p> <%= recommendation.recommendable.address %> </p>
              <% end %>
            </div>
        <%# <% end %>
        <%# <%= link_to "Delete", property_path(@property), data: { turbo_method: :delete, turbo_confirm: "Are you sure?" } %>
        </div>
      <% end %>
      </div>
    </div>
    </div>
    </div>
  <% end %>

  <%= link_to "Edit your selection", new_property_recommendation_path(@property) %>
</div>
